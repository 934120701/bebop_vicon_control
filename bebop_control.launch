<?xml version="1.0"?>
<launch>

  <arg name="bebop_ns" default="bebop1"/>
  <arg name="ip" default="192.168.42.1" />

  <!-- Through xwamthor -->
  <!-- <arg name="ip" default="192.168.2.104" /> -->

  <arg name="drone_type" default="bebop2" /> <!-- available drone types: bebop1, bebop2 -->
  <arg name="config_file" default="$(find bebop_driver)/config/defaults.yaml" />
  <arg name="camera_info_url" default="package://bebop_driver/data/$(arg drone_type)_camera_calib.yaml" />

  <param name="bebop_ns" default="bebop1" value="$(arg bebop_ns)" />

    <node name="bebop_controller" pkg="bebop_vicon_control" type="bebop_controller.py" output="screen">
      <!-- <remap from="goal_x" to="setpoint" /> -->
      <!-- <param name="bebop_ns" value="$(arg bebop_ns)" /> -->
      <param name="node_name" value="bebop_controller" />
     </node>

    <node name="bebop_geofence" pkg="bebop_vicon_control" type="bebop_geofence.py" output="screen">
      <!-- <remap from="goal_x" to="setpoint" /> -->
      <!-- <param name="bebop_ns" value="$(arg bebop_ns)" /> -->
      <param name="node_name" value="bebop_geofence" />
    </node>

    <group ns="$(arg bebop_ns)">
      <node pkg="bebop_driver" name="bebop_driver" type="bebop_driver_node" output="screen">
          <param name="camera_info_url" value="$(arg camera_info_url)" />
          <param name="bebop_ip" value="$(arg ip)" />
          <!-- <param name="PilotingSettingsAbsolutControlOn" value="1" /> -->
          <rosparam command="load" file="$(arg config_file)" />
      </node>
      <include file="$(find bebop_description)/launch/description.launch" />
  </group>

    <node pkg="vicon_bridge" type="vicon_bridge" name="vicon" output="screen">
      <param name="stream_mode" value="ClientPull" type="str" />
      <param name="datastream_hostport" value="mers-vicon.csail.mit.edu:801" type="str" />
      <!-- <param name="datastream_hostport" value="vicon:801" type="str" /> -->
      <param name="tf_ref_frame_id" value="/world" type="str" />
    </node>


    <node pkg="bebop_vicon_control" type="autonomous_landing.py" name="autonomous_landing" output="screen">
      <param name="node_name" value="autonomous_landing" />
    </node>


</launch>
